<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" class="dark">
  <head th:replace="~{layouts/app :: head}">
    <title>Home</title>
  </head>
  <body class="bg-background font-geist-sans text-foreground antialiased">
    <div th:replace="layouts/app :: header"></div>

    <div
      class="border-border flex h-16 items-center justify-between border-b px-8 py-4"
    >
      <h2 class="text-lg font-semibold" th:text="#{home.editor.title}"></h2>
      <div class="flex w-full flex-1 items-center justify-end gap-x-2">
        <div class="h-10 w-[200px] lg:w-[300px]"></div>
        <button
          class="uk-btn uk-btn-secondary"
          uk-toggle="#save"
          th:text="#{form.submit}"
        ></button>
        <div class="uk-flex-top uk-modal" id="save" uk-modal>
          <div class="uk-margin-auto-vertical uk-modal-dialog">
            <div class="uk-modal-header">
              <h2 class="uk-modal-title" th:text="#{home.editor.title}"></h2>
              <p
                class="text-muted-foreground mt-1.5 text-sm"
                th:text="#{home.modal.save.description}"
              ></p>
            </div>
            <div class="uk-modal-body space-y-4">
              <div class="space-y-2">
                <label
                  class="uk-form-label"
                  for="name"
                  th:text="#{home.modal.save.inputs.name}"
                ></label>
                <input class="uk-input" id="name" type="text" />
              </div>
              <div class="space-y-2">
                <label
                  class="uk-form-label"
                  for="slug"
                  th:text="#{home.modal.save.inputs.slug}"
                ></label>
                <input class="uk-input" id="slug" type="text" />
              </div>
            </div>
            <div class="uk-modal-footer text-right">
              <button
                class="uk-modal-close uk-btn uk-btn-primary"
                th:text="home.modal.save.inputs.name"
              ></button>
            </div>
          </div>
        </div>
        <button class="uk-btn uk-btn-secondary" th:text="#{share}"></button>
        <div
          class="uk-drop uk-dropdown w-[520px] p-4"
          uk-drop="mode: click; pos: bottom-right;"
        >
          <h3 class="text-lg font-semibold" th:text="#{share.title}"></h3>
          <p
            class="text-muted-foreground mt-1.5 text-sm"
            th:text="#{share.description}"
          ></p>
          <div class="flex items-center space-x-2 pt-4">
            <div class="flex-1">
              <input
                class="uk-input"
                readonly
                type="text"
                value="https://pad.criskell.com/c21qeqiojn"
              />
            </div>
            <div class="flex-none">
              <button class="uk-drop-close uk-btn uk-btn-primary uk-btn-icon">
                <uk-icon icon="copy"></uk-icon>
              </button>
            </div>
          </div>
        </div>
        <button class="uk-btn uk-btn-secondary uk-btn-icon">
          <span class="size-4"> <uk-icon icon="ellipsis"></uk-icon> </span>
        </button>
        <div
          class="uk-drop uk-dropdown"
          uk-drop="mode: click; pos: bottom-right"
        >
          <ul class="uk-dropdown-nav uk-nav">
            <li>
              <a class="uk-drop-close" th:text="#{options.preferences}"> </a>
            </li>
            <li class="uk-nav-divider"></li>
            <li>
              <a
                class="uk-drop-close text-destructive"
                th:text="#{options.paste.remove}"
              ></a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="flex gap-x-6 px-8 py-6" style="height: 700px">
      <div class="flex-1">
        <textarea
          class="uk-textarea h-full resize-none p-4"
          th:placeholder="#{home.editor.placeholder}"
          id="editor"
          name="editor"
        ></textarea>
      </div>
      <div class="flex-none" style="width: 200px">
        <span
          class="uk-form-label mb-4"
          th:text="#{home.editor.language.title}"
        >
        </span>

        <uk-select
          class="fr-select mt-4"
          cls-custom="button: uk-input-fake justify-between; dropdown: w-full"
          icon="chevrons-up-down"
          placeholder="Linguagem"
          searchable="true"
          i18n="search-placeholder: Buscar;"
        >
          <select hidden>
            <option>PHP</option>
          </select>
        </uk-select>
      </div>
    </div>
    <div class="flex gap-x-2 px-8 py-6 pt-0">
      <button
        class="uk-btn uk-btn-primary"
        th:text="#{form.submit}"
        id="pasteSave"
      ></button>
      <button class="uk-btn uk-btn-secondary uk-btn-icon">
        <span class="size-4"> <uk-icon icon="history"></uk-icon> </span>
      </button>
    </div>

    <script>
      async function savePaste() {
        const body = document.getElementById('editor').value;
        const language = 'php';
        const title = 'Paste';

        const response = await fetch('/pastes', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            title,
            body,
            language,
          }),
        });

        if (response.status === 201) {
          const body = await response.json();

          location.href = `/web/pastes/${body.shortId}`;
        }
      }

      document.getElementById('pasteSave').addEventListener('click', savePaste);
    </script>
  </body>
</html>
